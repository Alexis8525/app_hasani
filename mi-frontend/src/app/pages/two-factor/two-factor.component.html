<!-- two-factor.component.html (mejoras) -->
<div class="twofa-container">
    <div class="twofa-card">
      <h3>üîê Verificaci√≥n en Dos Pasos</h3>
      <p>Hemos enviado un c√≥digo de verificaci√≥n a:</p>
      <p class="user-email"><strong>{{ email }}</strong></p>
      
      <form [formGroup]="otpForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="otp">C√≥digo de Verificaci√≥n de 6 d√≠gitos</label>
          <input
            id="otp"
            type="text"
            formControlName="otp"
            class="form-control"
            placeholder="000000"
            maxlength="6"
            [class.is-invalid]="otpForm.get('otp')?.invalid && otpForm.get('otp')?.touched"
          />
          <div *ngIf="otpForm.get('otp')?.invalid && otpForm.get('otp')?.touched" class="error-message">
            Por favor ingresa los 6 d√≠gitos del c√≥digo
          </div>
        </div>
  
        <!-- Informaci√≥n del token (opcional) -->
        <div class="token-info" *ngIf="showTokenInfo">
          <p><small>Token temporal: {{ tempToken | slice:0:20 }}...</small></p>
        </div>
  
        <div class="alert-info">
          <p><strong>üí° ¬øNo recibiste el c√≥digo?</strong></p>
          <p>PIN de respaldo: <code class="offline-pin">{{ offlinePin }}</code></p>
          <small>Usa este PIN si no recibes el c√≥digo por correo</small>
          
          <button type="button" class="btn-resend" (click)="resendCode()" [disabled]="!canResend">
            {{ canResend ? 'Reenviar c√≥digo' : 'Reenviar en ' + resendCooldown + 's' }}
          </button>
        </div>
  
        <div *ngIf="errorMessage" class="alert-error">
          {{ errorMessage }}
        </div>
  
        <button type="submit" class="btn btn-primary" [disabled]="isLoading || otpForm.invalid">
          {{ isLoading ? '‚è≥ Verificando...' : '‚úÖ Verificar c√≥digo' }}
        </button>
  
        <button type="button" class="btn btn-secondary" (click)="useOfflinePin()" [disabled]="isLoading">
          üîë Usar PIN offline
        </button>
  
        <button type="button" class="btn btn-link" (click)="goBack.emit()">
          ‚Üê Volver al login
        </button>
      </form>
    </div>
  </div>
  