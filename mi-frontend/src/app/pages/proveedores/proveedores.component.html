<!-- proveedores.component.html -->
<div class="proveedores-container">
    <h2>🏭 Gestión de Proveedores</h2>
  
    <!-- Mensajes de estado -->
    <div *ngIf="errorMessage" class="alert alert-error">
      ❌ {{ errorMessage }}
    </div>
  
    <div *ngIf="successMessage" class="alert alert-success">
      ✅ {{ successMessage }}
    </div>
  
    <!-- Formulario de búsqueda -->
    <div class="search-section">
      <h3>🔍 Buscar Proveedores</h3>
      <form [formGroup]="searchForm" (ngSubmit)="searchByNombre()" class="search-form">
        <div class="form-group">
          <label for="searchTerm">Buscar por nombre:</label>
          <div class="search-controls">
            <input
              id="searchTerm"
              type="text"
              formControlName="searchTerm"
              placeholder="Ingrese nombre del proveedor..."
              class="form-control"
            />
            <button type="submit" class="btn btn-primary" [disabled]="isLoading">
              {{ isLoading ? '🔍 Buscando...' : '🔍 Buscar' }}
            </button>
            <button type="button" class="btn btn-secondary" (click)="resetSearch()" [disabled]="isLoading">
              📋 Ver Todos
            </button>
          </div>
        </div>
      </form>
    </div>
  
    <!-- Formulario de creación/edición -->
    <div class="form-section">
      <h3>{{ isEditing ? '✏️ Editar Proveedor' : '➕ Nuevo Proveedor' }}</h3>
      <form [formGroup]="proveedorForm" (ngSubmit)="isEditing ? onUpdate() : onCreate()" class="provider-form">
        <div class="form-row">
          <div class="form-group">
            <label for="nombre">Nombre *</label>
            <input
              id="nombre"
              type="text"
              formControlName="nombre"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('nombre')"
              [readonly]="!canEditNombre()"
              placeholder="Nombre del proveedor"
            />
            <div *ngIf="isFieldInvalid('nombre')" class="error-message">
              {{ getFieldError('nombre') }}
            </div>
          </div>
  
          <div class="form-group">
            <label for="telefono">📞 Teléfono</label>
            <input
              id="telefono"
              type="text"
              formControlName="telefono"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('telefono')"
              placeholder="10 dígitos (opcional)"
            />
            <div *ngIf="isFieldInvalid('telefono')" class="error-message">
              {{ getFieldError('telefono') }}
            </div>
          </div>
  
          <div class="form-group">
            <label for="contacto">👤 Contacto</label>
            <input
              id="contacto"
              type="text"
              formControlName="contacto"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('contacto')"
              placeholder="Persona de contacto (opcional)"
            />
            <div *ngIf="isFieldInvalid('contacto')" class="error-message">
              {{ getFieldError('contacto') }}
            </div>
          </div>
        </div>
  
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn btn-primary" 
            [disabled]="isLoading || proveedorForm.invalid"
          >
            {{ isLoading ? '⏳ Procesando...' : (isEditing ? '💾 Actualizar' : '➕ Crear') }}
          </button>
          
          <button 
            *ngIf="isEditing" 
            type="button" 
            class="btn btn-secondary" 
            (click)="cancelEdit()"
            [disabled]="isLoading"
          >
            ❌ Cancelar
          </button>
        </div>
      </form>
    </div>
  
    <!-- Lista de proveedores -->
    <div class="list-section">
      <h3>
        {{ 
          searchMode === 'all' ? '📋 Todos los Proveedores' :
          '🔍 Resultados de Búsqueda'
        }} ({{ filteredProveedores.length }})
      </h3>
  
      <div *ngIf="isLoading" class="loading">
        ⏳ Cargando proveedores...
      </div>
  
      <div *ngIf="!isLoading && filteredProveedores.length === 0" class="no-data">
        📭 No se encontraron proveedores
      </div>
  
      <div *ngIf="!isLoading && filteredProveedores.length > 0" class="proveedores-grid">
        <div *ngFor="let proveedor of filteredProveedores" class="proveedor-card">
          <div class="proveedor-info">
            <h4>🏭 {{ proveedor.nombre }}</h4>
            <p *ngIf="proveedor.telefono"><strong>📞 Teléfono:</strong> {{ proveedor.telefono }}</p>
            <p *ngIf="proveedor.contacto"><strong>👤 Contacto:</strong> {{ proveedor.contacto }}</p>
            <p><strong>🆔 ID:</strong> {{ proveedor.id_proveedor }}</p>
          </div>
          <div class="proveedor-actions">
            <button 
              class="btn btn-warning btn-sm" 
              (click)="onEdit(proveedor)"
              [disabled]="isLoading"
              title="Editar proveedor"
            >
              ✏️ Editar
            </button>
            <button 
              class="btn btn-danger btn-sm" 
              (click)="onDelete(proveedor.nombre)"
              [disabled]="isLoading"
              title="Eliminar proveedor"
            >
              🗑️ Eliminar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  